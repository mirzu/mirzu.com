---
import BaseHead from '../components/BaseHead.astro'
import Navbar from '../components/Navbar.astro'
import Footer from '../components/Footer.astro'
import { SITE_TITLE, SITE_DESCRIPTION, GTM_CONTAINER_ID } from '../consts'

interface Props {
	title?: string
	description?: string
}

const { title, description } = Astro.props

import '@fontsource-variable/inter'
import '@fontsource-variable/jetbrains-mono'
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead
			title={title || SITE_TITLE}
			description={description || SITE_DESCRIPTION}
		/>
		<style>
			@keyframes pageFadeIn {
				from {
					opacity: 0;
					transform: translateY(20px) scale(0.98);
					filter: blur(4px);
				}
				to {
					opacity: 1;
					transform: translateY(0) scale(1);
					filter: blur(0);
				}
			}

			.page-content {
				animation: pageFadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
				transition:
					opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1),
					transform 0.6s cubic-bezier(0.4, 0, 0.2, 1),
					filter 0.6s cubic-bezier(0.4, 0, 0.2, 1);
			}

			.page-content.transitioning {
				opacity: 0;
				transform: translateY(-20px) scale(0.98);
				filter: blur(4px);
			}
		</style>
	</head>
	<body
		class="text-foreground bg-background font-light dark:text-foreground-dark dark:bg-background-dark transition-colors"
	>
		<!-- Google Tag Manager (noscript) -->
		<noscript><iframe src={`https://www.googletagmanager.com/ns.html?id=${GTM_CONTAINER_ID}`}
		height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<!-- End Google Tag Manager (noscript) -->
		<Navbar title={SITE_TITLE} />
		<div class="page-content" id="page-content">
			<slot />
		</div>
		<Footer />
		<script>
			document.addEventListener('DOMContentLoaded', () => {
				const robotLink = document.getElementById('robot-link')
				const pageContent = document.getElementById('page-content')

				if (robotLink && pageContent) {
					robotLink.addEventListener('click', (e) => {
						e.preventDefault()
						const href = robotLink.getAttribute('href')

						pageContent.classList.add('transitioning')

						setTimeout(() => {
							if (href) window.location.href = href
						}, 600)
					})
				}
			})
		</script>
	</body>
</html>
